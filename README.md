# Telegram бот для получения METAR и TAF

Бот для Telegram, который получает актуальные метеорологические данные (METAR и TAF) для аэропортов по коду ИКАО.

## Возможности

- ✅ Получение METAR данных для аэропорта
- ✅ Получение TAF данных для аэропорта
- ✅ Валидация кода аэропорта ИКАО (4 буквы)
- ✅ Простой и удобный интерфейс

## Установка

1. Клонируйте репозиторий или скачайте файлы

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Получите токен бота:
   - Откройте Telegram и найдите [@BotFather](https://t.me/BotFather)
   - Отправьте команду `/newbot`
   - Следуйте инструкциям для создания бота
   - Скопируйте полученный токен

4. Настройка (нормальный вариант для GitHub + деплоя):
   - Скопируйте `env.example` в `.env` и вставьте токен в `BOT_TOKEN`
   - На сервере вместо файла можно (и лучше) задать переменную окружения `BOT_TOKEN`

## Запуск

```bash
python bot.py
```

## Переменные окружения (для деплоя)

- `BOT_TOKEN` — токен Telegram-бота (обязательно)
- (также принимаются `TELEGRAM_BOT_TOKEN` или `TELEGRAM_TOKEN`)
- `METAR_URL_TEMPLATE` (опционально)
- `TAF_URL_TEMPLATE` (опционально)
- `VATSIM_METAR_URL_TEMPLATE` (опционально)
- `VATSIM_TAF_URL_TEMPLATE` (опционально)

## Railway (важно)

- В Railway откройте **Variables** и добавьте `BOT_TOKEN=...`
- Убедитесь, что сервис запущен **в 1 экземпляре** (если запустить 2, будет ошибка Telegram `409 Conflict`)

## Автоматический деплой на Railway (GitHub Actions)

Проект поддерживает автоматический деплой через GitHub Actions при push в main ветку.

**Настройка:**

1. На GitHub откройте **Settings** → **Secrets and variables** → **Actions**
2. Добавьте новый secret:
   - **Name:** `RAILWAY_TOKEN`
   - **Value:** [Ваш Railway API токен](https://railway.app/account/tokens)
   - Получить токен: откройте Railway → Account → API Tokens → Create New Token

3. Загрузьте код на GitHub:
```bash
git push origin main
```

4. GitHub Actions автоматически запустит деплой

**Токен полностью защищен:**
- ✅ Хранится в GitHub Secrets (не видно в коде)
- ✅ Не попадает в логи
- ✅ Используется только для деплоя

## Использование

1. Найдите вашего бота в Telegram
2. Отправьте команду `/start`
3. Введите код аэропорта в формате ИКАО (4 заглавные буквы)
   - Примеры: `UUEE`, `KORD`, `EGLL`, `LFPG`
4. Бот вернет актуальные данные METAR и TAF

## Команды

- `/start` - Начать работу с ботом
- `/help` - Показать справку

## Примеры кодов аэропортов ИКАО

- `UUEE` - Шереметьево (Москва, Россия)
- `KORD` - O'Hare (Чикаго, США)
- `EGLL` - Хитроу (Лондон, Великобритания)
- `LFPG` - Шарль де Голль (Париж, Франция)
- `EDDF` - Франкфурт (Германия)

## Технические детали

- Использует открытые текстовые источники NOAA/NWS (`tgftp.nws.noaa.gov`) для получения METAR и TAF
- Имеет **запасной источник** METAR/TAF: `metar.vatsim.net`
- Библиотека: python-telegram-bot
- Язык: Python 3.7+

## Примечания

- Данные METAR обновляются каждый час
- Данные TAF обновляются каждые 6 часов
- Если данные для аэропорта недоступны, бот сообщит об этом

